# Overview Related Work

## Related Work in Baseband Exploitation

- OTA-Fuzzing corresponds to Hardware-In-The-Loop Fuzzing

| Work                                                                                                                                           | Research Approach (Category) | Academic/Industrial Research | Target Baseband                                                                                                                                                                       | Target Protocol Version                     | Target Protocol Component                                                                                                                                                                                                                                                                                                               | Open Source                      | Description                                                                                                                                                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [BaseComp (2023)](./static-analysis/basecomp.md)                                                                                               | Static-Analysis              | Academic                     | 16 Images: 10 Samsung (ARM), 5 MTK, 1 srsRAN (all versions provided) (- Samsung: Galaxy S8, S8+, S9, S9+, S10e, S10+, S10 5G, S21 5G, S21+ 5G, S21 Ultra 5G - srsRAN: open source UE) | LTE & 5G                                    | Integrity Protection Function during Non-Access-Stratum (NAS) setup. Located on Layer 3 (session management, call control & user authentication) (- After receiving a message, the BP has to check whether the message is security protected; - If yes: Integrity (i.e. MAC) has to be checked before being processed (e.g. decrypted)) | Yes                              | Create a factor graph for the integrity protection function (- Graph with variables and functions, where input -> fn -> output; - Use probability theory to compute the relative probability of a variable being true (depending on the inputs & functions)) |
| [BaseSpec (2021)](./static-analysis/basespec.md)                                                                                               | Static-Analysis              | Academic                     | No information on vendors/firmware shared                                                                                                                                             | None                                        | L3 message formats                                                                                                                                                                                                                                                                                                                      | Yes (No vendor-specifics though) | Compares the vendor-specific message formats with extracted formats from the specification - if a mismatch is found it is a verified bug                                                                                                                     |
| [Semantic-Enhanced Static vulnerability Detection in Baseband Firmware (2024)](./static-analysis/semantic-enhanced-vulnerability-detection.md) | Static-Analysis              | Academic                     | Same baseband firmware as in [FirmWire](./re-hosting/firmwire.md). Source additionally: [SamMobile](https://www.sammobile.com/firmwares)                                              | No specifics (though no 5G vulnerabilities) | No specifics (Patterns analyzed)                                                                                                                                                                                                                                                                                                        | Yes                              | Taint analysis and propagation of bugs to find entry points.                                                                                                                                                                                                 |
| [LTEInspector (2020)](./static-analysis/lteinspector.md)                                                                                       | Static-Analysis              |                              |                                                                                                                                                                                       |                                             |                                                                                                                                                                                                                                                                                                                                         |                                  |                                                                                                                                                                                                                                                              |
| [5GReasoner](./static-analysis/5greasoner.md)                                                                                                  | Static-Analysis              |                              |                                                                                                                                                                                       |                                             |                                                                                                                                                                                                                                                                                                                                         |                                  |                                                                                                                                                                                                                                                              |
| [Atomic: Bookworm Game](./static-analysis/bookworm.md)                                                                                         | Static-Analysis              | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                | ?                                                                                                                                                                                                                                                            |
| ------                                                                                                                                         | ----                         | ---                          | ---                                                                                                                                                                                   | ---                                         | ---                                                                                                                                                                                                                                                                                                                                     | ---                              | ---                                                                                                                                                                                                                                                          |
| [BaseSAFE](./re-hosting/baseSAFE.md)                                                                                                           | Re-Hosting                   | Academic                     | Nucleus RTOS-based MediaTek cellular baseband                                                                                                                                         | 4G                                          | Layer 3 Signaling messages: unencrypted & pre-authentication messages                                                                                                                                                                                                                                                                   | Yes                              | Selectively re-host components of basebands: determine a function that should be analyzed (i.e. a task). Uses hooks for sanitization to find memory safety vulnerabilities. Uses a memory dump as a starting point.                                          |
| [FirmWire](./re-hosting/firmwire.md)                                                                                                           | Re-Hosting                   | Academic                     | - 212 images from Samsung and MediaTek (9 devices)                                                                                                                                    | GSM & LTE                                   | Mainly pre-authentication attacks for unauthenticated phones.                                                                                                                                                                                                                                                                           | Yes                              | Re-host the entire baseband and try to boot it successfully. This is achieved by emulating external hardware and writing a framework that supports similar basebands.                                                                                        |
| [Exploring the MediaTek baseband (Presentation from 2020)](./re-hosting/mtk-fuzzing.md)                                                        | Re-Hosting                   | Industrial                   | MediaTek: Huawei (Mate 30 Pro, portable 5G router), Samsung Galaxy Note 10                                                                                                            | 5G                                          | No specifics (Randomly selected tasks and parsers)                                                                                                                                                                                                                                                                                      | No                               | Approach: Write a C wrapper to call the target function - linking and compiling APIs used - task level fuzzing - **without memory snapshots**                                                                                                                |
| ------                                                                                                                                         | ----                         | ---                          | ---                                                                                                                                                                                   | ---                                         | ---                                                                                                                                                                                                                                                                                                                                     | ---                              | ---                                                                                                                                                                                                                                                          |
| [5GBaseChecker (2024)](./ota-fuzzing/5gbasechecker.md)                                                                                         | Black-Box OTA Fuzzing        | Academic                     | MediaTek, Samsung, Qualcomm (No constraints as the devices' software is not analyzed but tested)                                                                                      | 5G                                          | NAS & RRC                                                                                                                                                                                                                                                                                                                               | Yes                              | Create state machines for different 5G baseband implementations via passive & active protocol learning (to synthesize state machines). Find deviations in between vendor state machines which show that one of the implementations has a fault               |
| [LTEFuzz: Touching the Untouchables: Dynamic Security Analysis of the LTE Control Plane](./ota-fuzzing/untouchables.md)                        | Black-Box OTA Fuzzing        | ?                            | ?                                                                                                                                                                                     | LTE                                         | NAS and Radio Resource Control (RRC) Messages (Layer 3)                                                                                                                                                                                                                                                                                 | No                               | ?                                                                                                                                                                                                                                                            |
| [DoLTEst](./ota-fuzzing/doltest.md)                                                                                                            | Black-Box OTA Fuzzing        | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                | ?                                                                                                                                                                                                                                                            |
| [T-Fuzz](./ota-fuzzing/t-fuzz.md)                                                                                                              | Black-Box OTA Fuzzing ?      | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                | ?                                                                                                                                                                                                                                                            |
| [UE security reloaded: Developing a 5g standalone user-side security testing framework](./ota-fuzzing/ue-security-testing-fw.md)               | Black-Box OTA Fuzzing        | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                | ?                                                                                                                                                                                                                                                            |
| [SecChecker](./ota-fuzzing/sec-checker.md)                                                                                                     | ?                            | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                | ?                                                                                                                                                                                                                                                            |
| [BleDiff (2023)](./ota-fuzzing/blediff.md)                                                                                                     | ?                            | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                | ?                                                                                                                                                                                                                                                            |
| [Noncompliance as a behavior (2021)](./ota-fuzzing/noncompliance-as-a-behavior.md)                                                             |                              |                              |                                                                                                                                                                                       |                                             |                                                                                                                                                                                                                                                                                                                                         |                                  |                                                                                                                                                                                                                                                              |
| ---                                                                                                                                            | ---                          | ---                          | ---                                                                                                                                                                                   | ---                                         | ---                                                                                                                                                                                                                                                                                                                                     | ---                              | ---                                                                                                                                                                                                                                                          |
| [A walk with Shannon](./manual/a-walk-with-shannon.md)                                                                                         | Manual                       | Industrial                   | Samsung (specific)                                                                                                                                                                    |                                             |                                                                                                                                                                                                                                                                                                                                         |                                  |                                                                                                                                                                                                                                                              |


## Assumed Threat Model

- BaseComp: Attacker intercepts, drops, injects and modifies messages between the base station and the victim
    - Cryptographic keys are assumed to be secure: Attacker cannot counterfeit messages with a correct MAC
- FirmWire: Rouge base station
    - Claimed to be "most realistic"
    - No prior authentication performed - attacks should be possible on arbitrary phones

- NOTE: Extend attacker model to a mobile network operator (MNO) who exploits his position?
    - Advantage: extends the attacker surface

## Related Work in Protocol Learning

- Initial work - formal modeling
- IJON for protocol fuzzing


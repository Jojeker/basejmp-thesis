# Overview Related Work

## Related Work in Baseband Exploitation

- OTA-Fuzzing corresponds to Hardware-In-The-Loop Fuzzing

| Work                                                                                                                                                                                                                                                       | Research Approach (Category)          | Academic/Industrial Research | Target Baseband                                                                                                                                                                       | Target Protocol Version                     | Target Protocol Component                                                                                                                                                                                                                                                                                                               | Open Source                       | Description                                                                                                                                                                                                                                                                                                                                                                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [BaseComp (2023)](./static-analysis/basecomp.md)                                                                                                                                                                                                           | Static-Analysis                       | Academic                     | 16 Images: 10 Samsung (ARM), 5 MTK, 1 srsRAN (all versions provided) (- Samsung: Galaxy S8, S8+, S9, S9+, S10e, S10+, S10 5G, S21 5G, S21+ 5G, S21 Ultra 5G - srsRAN: open source UE) | LTE & 5G                                    | Integrity Protection Function during Non-Access-Stratum (NAS) setup. Located on Layer 3 (session management, call control & user authentication) (- After receiving a message, the BP has to check whether the message is security protected; - If yes: Integrity (i.e. MAC) has to be checked before being processed (e.g. decrypted)) | Yes                               | Create a factor graph for the integrity protection function (- Graph with variables and functions, where input -> fn -> output; - Use probability theory to compute the relative probability of a variable being true (depending on the inputs & functions))                                                                                                                                                      |
| [BaseSpec (2021)](./static-analysis/basespec.md)                                                                                                                                                                                                           | Static-Analysis                       | Academic                     | No information on vendors/firmware shared                                                                                                                                             | None                                        | L3 message formats                                                                                                                                                                                                                                                                                                                      | Yes (No vendor-specifics though)  | Compares the vendor-specific message formats with extracted formats from the specification - if a mismatch is found it is a verified bug                                                                                                                                                                                                                                                                          |
| [Semantic-Enhanced Static vulnerability Detection in Baseband Firmware (2024)](./static-analysis/semantic-enhanced-vulnerability-detection.md)                                                                                                             | Static-Analysis                       | Academic                     | Same baseband firmware as in [FirmWire](./re-hosting/firmwire.md). Source additionally: [SamMobile](https://www.sammobile.com/firmwares)                                              | No specifics (though no 5G vulnerabilities) | No specifics (Patterns analyzed)                                                                                                                                                                                                                                                                                                        | Yes                               | Taint analysis and propagation of bugs to find entry points.                                                                                                                                                                                                                                                                                                                                                      |
| [LTEInspector (2020)](./static-analysis/lteinspector.md)                                                                                                                                                                                                   | Static-Analysis                       | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [5GReasoner](./static-analysis/5greasoner.md)                                                                                                                                                                                                              | Static-Analysis                       | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [Atomic: Bookworm Game](./static-analysis/bookworm.md)                                                                                                                                                                                                     | Static-Analysis                       | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [Hermes: Unlocking Security Analysis of Cellular Network Protocols by Synthesizing Finite State Machines from Natural Language Specifications] [Source](https://arxiv.org/abs/2310.04381)                                                                  | Synthesizing State machines with ML   | Academic                     | ?                                                                                                                                                                                     | 5G and LTE                                  | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------                                                                                                                                                                                                                                                     | ----                                  | ---                          | ---                                                                                                                                                                                   | ---                                         | ---                                                                                                                                                                                                                                                                                                                                     | ---                               | ---                                                                                                                                                                                                                                                                                                                                                                                                               |
| [BaseSAFE](./re-hosting/baseSAFE.md)                                                                                                                                                                                                                       | Re-Hosting                            | Academic                     | Nucleus RTOS-based MediaTek cellular baseband                                                                                                                                         | 4G                                          | Layer 3 Signaling messages: unencrypted & pre-authentication messages                                                                                                                                                                                                                                                                   | Yes                               | Selectively re-host components of basebands: determine a function that should be analyzed (i.e. a task). Uses hooks for sanitization to find memory safety vulnerabilities. Uses a memory dump as a starting point.                                                                                                                                                                                               |
| [FirmWire](./re-hosting/firmwire.md)                                                                                                                                                                                                                       | Re-Hosting                            | Academic                     | - 212 images from Samsung and MediaTek (9 devices)                                                                                                                                    | GSM & LTE                                   | Mainly pre-authentication attacks for unauthenticated phones.                                                                                                                                                                                                                                                                           | Yes                               | Re-host the entire baseband and try to boot it successfully. This is achieved by emulating external hardware and writing a framework that supports similar basebands.                                                                                                                                                                                                                                             |
| [Exploring the MediaTek baseband (Presentation from 2020)](./re-hosting/mtk-fuzzing.md)                                                                                                                                                                    | Re-Hosting                            | Industrial                   | MediaTek: Huawei (Mate 30 Pro, portable 5G router), Samsung Galaxy Note 10                                                                                                            | 5G                                          | No specifics (Randomly selected tasks and parsers)                                                                                                                                                                                                                                                                                      | No                                | Approach: Write a C wrapper to call the target function - linking and compiling APIs used - task level fuzzing - **without memory snapshots**                                                                                                                                                                                                                                                                     |
| [How To Hack Shannon Baseband (Google 2023)](https://www.youtube.com/watch?v=LJ1NzJLMDUs) [a](./manual/shannon-google.md)                                                                                                                                  | Partial Re-Hosting (BaseSAFE)         | Industrial                   | Pixel 7 (Shannon)                                                                                                                                                                     | LTE and above (VoIP capable)                | VoLTE/VoNR P2P protocols that can run on the baseband (for efficiency)                                                                                                                                                                                                                                                                  | No                                | Attack victim by placing a phone call. Finding vulnerabilities by fuzzing the parsers for SDP and SIP. Increased effort, since the payload must also pass the core network, which might rewrite/filter packets.                                                                                                                                                                                                   |
| ------                                                                                                                                                                                                                                                     | ----                                  | ---                          | ---                                                                                                                                                                                   | ---                                         | ---                                                                                                                                                                                                                                                                                                                                     | ---                               | ---                                                                                                                                                                                                                                                                                                                                                                                                               |
| [5Ghoul](./ota-fuzzing/5ghoul.md)                                                                                                                                                                                                                          | Black-Box OTA Fuzzing                 | Academic                     | ?                                                                                                                                                                                     | 5G                                          | NAS, RRC (connection setup only)                                                                                                                                                                                                                                                                                                        | Yes                               | Performs fuzzing with running OTA against real basebands.                                                                                                                                                                                                                                                                                                                                                         |
| [5GBaseChecker (2024)](./ota-fuzzing/5gbasechecker.md)                                                                                                                                                                                                     | Black-Box OTA Fuzzing                 | Academic                     | MediaTek, Samsung, Qualcomm (No constraints as the devices' software is not analyzed but tested)                                                                                      | 5G                                          | NAS & RRC                                                                                                                                                                                                                                                                                                                               | Yes                               | Create state machines for different 5G baseband implementations via passive & active protocol learning (to synthesize state machines). Find deviations in between vendor state machines which show that one of the implementations has a fault                                                                                                                                                                    |
| [LTEFuzz: Touching the Untouchables: Dynamic Security Analysis of the LTE Control Plane](./ota-fuzzing/untouchables.md)                                                                                                                                    | Black-Box OTA Fuzzing                 | ?                            | ?                                                                                                                                                                                     | LTE                                         | NAS and Radio Resource Control (RRC) Messages (Layer 3)                                                                                                                                                                                                                                                                                 | No                                | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [DoLTEst](./ota-fuzzing/doltest.md)                                                                                                                                                                                                                        | Black-Box OTA Fuzzing                 | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [UE security reloaded: Developing a 5g standalone user-side security testing framework](./ota-fuzzing/ue-security-testing-fw.md)                                                                                                                           | Black-Box OTA Fuzzing                 | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [SecChecker](./ota-fuzzing/sec-checker.md)                                                                                                                                                                                                                 | ?                                     | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [BleDiff (2023)](./ota-fuzzing/blediff.md)                                                                                                                                                                                                                 | ?                                     | ?                            | ?                                                                                                                                                                                     | ?                                           | ?                                                                                                                                                                                                                                                                                                                                       | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [Noncompliance as a behavior (2021)](./ota-fuzzing/noncompliance-as-a-behavior.md)                                                                                                                                                                         |                                       |                              |                                                                                                                                                                                       |                                             |                                                                                                                                                                                                                                                                                                                                         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ---                                                                                                                                                                                                                                                        | ---                                   | ---                          | ---                                                                                                                                                                                   | ---                                         | ---                                                                                                                                                                                                                                                                                                                                     | ---                               | ---                                                                                                                                                                                                                                                                                                                                                                                                               |
| [A walk with Shannon](./manual/a-walk-with-shannon.md)                                                                                                                                                                                                     | Manual                                | Industrial                   | Samsung (specific)                                                                                                                                                                    |                                             |                                                                                                                                                                                                                                                                                                                                         |                                   |                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [Over the Air, under the radar (2023)](./manual/over-the-air.md) [Video](https://www.youtube.com/watch?v=KnN4NkaGCwE)                                                                                                                                      | Re-Hosting + Host-based Fuzzing       | Industrial                   | Pixel Smartphones                                                                                                                                                                     | 2G & 4G                                     | 2G Pre-AKA + Post-AKA, 4G Pre-AKA, various parsers                                                                                                                                                                                                                                                                                      | No!                               | Apparently able to fully rehost with symbols and high accuracy, which is superior to FirmWire. No information on how they achieved it!
| [Overcoming State: Finding vulnerabilities by Fuzzing Layer-2](./re-hosting/overcoming-state.md) [Video](https://vimeo.com/998851679)                                                                                                                      | Re-Hosting                            | Academic                     | Samsung Exynos (Cortex-R)                                                                                                                                                             | 2G                                          | Starting from Layer 2 up to all following Layers (3+)                                                                                                                                                                                                                                                                                   | Yes (FirmWire)                    | Create a state and perform Fuzzing from Layer 2. The idea is that the state setup is additional effort, but very useful, as it mimicks real execution conditions.                                                                                                                                                                                                                                                 |
| [BaseMirror: Automatic Reverse Engineering of Baseband Commands from Android’s Radio Interface Layer](./ap/basemirror.md)  [Source](https://arxiv.org/html/2409.00475v1#bib.bib67)                                                                         | Attack from AP to BP                  | Academic                     | ?                                                                                                                                                                                     | Protocol between AP and BP                  | Generating the specification state machine                                                                                                                                                                                                                                                                                              | ?                                 | ?                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [Over the Air Baseband Exploit: Gaining Remote Code Execution on 5G Smartphones](https://www.blackhat.com/us-21/briefings/schedule/#over-the-air-baseband-exploit-gaining-remote-code-execution-on-5g-smartphones-23199) (contains a very exhaustive PDF!) | Manual (Investigation of `modem.bin`) | Industrial                   | Vivo S6 5G: SoC Exynos 980 with Samsung Shannon Baseband                                                                                                                              | 5G                                          | XML parser in VoLTE/VoNR                                                                                                                                                                                                                                                                                                                | Yes (Whitepaper is documentation) | The authors were able to find the XML  parser by manually inspecting the binary of the modem. They noticed, that there is no security check for buffer lengths, allowing them to exploit the detected vulnerability in the parser.                                                                                                                                                                                |
| [Burned in Ashes (2019)](https://infocon.org/cons/REcon/REcon%202019%20Montreal/REcon%202019%20Montreal%20videos/Guy.Burned%20in%20AshesBaseband%20Fairy%20Tale%20Stories-WXoRdFBuXytGB.mp4)                                                               | Manual                                | Industrial                   | Infineon basebands (Iphone)                                                                                                                                                           | LTE and below                               | [Architecture of an Infineon Baseband](../../assets/infineon-rev/basic-architecture.png)                                                                                                                                                                                                                                                | No                                | A lot of code that is autogenerated has been found. Heap-shaping was done with mesages for Activation, Deactivation and Modification (malloc, free, modify). Manual search for vulnerabilities. **Re-Hosting of Infineon baseband with qemu x86 (because the Infineon baseband was initially x86) was an attempt that failed**. Instead fuzzing of the binary recompiled by replacing the calls (functions only). |
| [How To Tame Your Unicorn](https://www.blackhat.com/us-21/briefings/schedule/#how-to-tame-your-unicorn---exploring-and-exploiting-zero-click-remote-interfaces-of-modern-huawei-smartphones-233371626915693)                                               | Manual & Fuzzing                      | Industrial                   | Huawei's Kirin SoCs                                                                                                                                                                   | LTE and below                               | Access Stratum specifics (AS) - parts that use the CSN.1 parser                                                                                                                                                                                                                                                                         | No                                | Finding vulnerabilities in the CSN.1 parsers by reversing the virtual machine.                                                                                                                                                                                                                                                                                                                                    |
| [Basebandheimer (2023)](./manual/basebanheimer.md)                                                                                                                                                                                                    | Manual                                | Industrial                   | Shannon & Mediatek (also AP from BB)                                                                                                                                                  | No specifics                                | L2 and IPC protocols                                                                                                                                                                                                                                                                                                                    | No                                | Attacking Layer 2 and IPC for Both Shannon and MediaTek.


## Misc Learning Material

- [Demystifying IMSI Catchers](https://infocon.org/cons/ShmooCon/ShmooCon%202019/Demystifying%20IMSI%20Catchers.mp4) with [Documentation](../../background/imsi.md)                                                                                                                                   | Background on IMSI                    | Academic                     | N/a                                                                                                                                                                                   | Layer 3: Non-Access-Stratum                 | Non-Access-Stratum                                                                                                                                                                                                                                                                                                                      | No                                | IMSI = International Mobile Subscriber Number: IMSI Catchers are used to capture the presence of phones and identify them. [See the background information for more](../../background/imsi.md)                                                                                                                                                                                                                   |
- [T-Fuzz](./ota-fuzzing/t-fuzz.md) - Protocol Fuzzing (White Box?)

## Assumed Threat Model

- BaseComp: Attacker intercepts, drops, injects and modifies messages between the base station and the victim
    - Cryptographic keys are assumed to be secure: Attacker cannot counterfeit messages with a correct MAC
- FirmWire: Rouge base station
    - Claimed to be "most realistic"
    - No prior authentication performed - attacks should be possible on arbitrary phones

- NOTE: Fully Remote Attack Vector (proposed in "Burned in Ashes")
    - Assume that the phone is already registered with a carrier
    - Send custom payload ove the network via the core network

- NOTE: Attack from a "phone" 
    - VoLTE/VoNR as an attack surface because of P2P protocols
    - Essentially everything that has some session initiation to it

- NOTE: Extend attacker model to a mobile network operator (MNO) who exploits his position?
    - Advantage: extends the attacker surface
    - NOTE: SIMurai argues like this: if you go on vacation and get a new sim card, you are assigned
      a new MNO, which might be malicious
        - This might be exploitable and extends the range of the attack

## Related Work in Protocol Learning

- Initial work - formal modeling
- IJON for protocol fuzzing

